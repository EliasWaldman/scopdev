// Dynamic adaptive
let da_elements = document.querySelectorAll('[data-da]');
let parents_original = [];
let attr_elements = [];
let attr_element = [];
let match_media = [];

for (let item of da_elements) {
    let parentChildren = item.parentElement.children;
    for (let i = 0; i < parentChildren.length; i++) {
        if (parentChildren[i] == item) {
            parents_original.push({
                'parent': item.parentElement,
                'index': i
            })
        }
    }
}

for (let item of da_elements) {
    attr_elements.push(item.dataset.da);
}

for (let i = 0; i < attr_elements.length; i++) {
    match_media.push(window.matchMedia("(max-width:" + attr_elements[i].split(', ')[2] + "px)"));
    // match_media.push(window.matchMedia("(min-width:" + attr_elements[i].split(', ')[2] + "px)")); // для MobileFirst
    match_media[i].addEventListener('change', dinamic_adapt);
}

function dinamic_adapt() {
    for (let i = 0; i < match_media.length; i++) {
        if (match_media[i].matches) {
            attr_element = attr_elements[i].split(', ');
            document.querySelector(`.${attr_element[0]}`).insertBefore(da_elements[i], document.querySelector(`.${attr_element[0]}`).children[attr_element[1]]);
        } else {
            parents_original[i].parent.insertBefore(da_elements[i], parents_original[i].parent.children[parents_original[i].index]);
        }
    }
}

dinamic_adapt();

// IBG
let ibg = document.querySelectorAll('.ibg');

if (ibg) {
    for (let item of ibg) {
        let ibgImg = item.querySelector('img');
        let ibgImgSrc = ibgImg.getAttribute('src');
        item.style.backgroundImage = `url(${ibgImgSrc})`;
    }
}

// Header Mobile
let body = document.querySelector('body');
let burger = document.querySelector('.header__burger');
let header_mobile = document.querySelector('.header__mobile');

if (burger) {
    burger.addEventListener('click', function (event) {
        event.preventDefault();

        body.classList.toggle('lock');
        burger.classList.toggle('active');
        header_mobile.classList.toggle('active');
    })
}

// Header Fixed
let main = document.querySelector('.main');
let header = document.querySelector('.header');
let firts_block;
let firts_block_height;

window.addEventListener('scroll', function (event) {
    if (main && header) {
        firts_block = main.children[0];
        firts_block_height = firts_block.getBoundingClientRect().height;

        if (document.documentElement.scrollTop > firts_block_height) {
            header.classList.add('fixed');
        } else {
            header.classList.remove('fixed');
        }
    }
});

// Slider Blog
if (document.querySelector('.slider-blog-block__swiper')) {
    const swiperBlog = new Swiper('.slider-blog-block__swiper', {
        // Optional parameters
        loop: true,
        slidesPerView: 4,
        spaceBetween: 20,

        // Navigation arrows
        navigation: {
            nextEl: '.navigation-blog-block__btn_next',
            prevEl: '.navigation-blog-block__btn_prev',
        },

        // Responsive breakpoints
        breakpoints: {
            320: {
                slidesPerView: 2,
            },
            700: {
                slidesPerView: 3,
            },
            992: {
                slidesPerView: 4,
            }
        }
    });
}

// Accordion question
if (document.querySelector('.top-item-question')) {
    $('.top-item-question').click(function () {
        $(this).toggleClass('active');
        $(this).next().slideToggle(300);
    });
}

// Values Open
let values_items = document.querySelectorAll('.values__item');

if (document.querySelector('.values__items')) {
    values_items.forEach(function (values_item) {
        values_item.addEventListener('click', function (event) {
            event.preventDefault();

            values_items.forEach(function (item) {
                item.classList.remove('active');
            })

            values_item.classList.add('active');
        })
    })
}

// Filter
// let nav_filter_items = document.querySelectorAll('.nav-filter__item');
// let main_blog_columns = document.querySelectorAll('.main-blog__column');
//
// if (nav_filter_items) {
//     nav_filter_items.forEach(function (nav_filter_item) {
//         nav_filter_item.addEventListener('click', function (event) {
//             event.preventDefault();
//
//             nav_filter_items.forEach(function (item) {
//                 item.classList.remove('active');
//             })
//
//             nav_filter_item.classList.add('active');
//
//             if (nav_filter_item.dataset.filter === 'all') {
//                 main_blog_columns.forEach(function (main_blog_column) {
//                     main_blog_column.classList.remove('hide');
//                 })
//             } else {
//                 main_blog_columns.forEach(function (main_blog_column) {
//                     if (main_blog_column.dataset.filter == nav_filter_item.dataset.filter) {
//                         main_blog_column.classList.remove('hide');
//                     } else {
//                         main_blog_column.classList.add('hide');
//                     }
//                 })
//             }
//         })
//     })
// }

$('.copy').on('click', function (e) {
    e.preventDefault();
    let that = $(this)

    let dummy = document.createElement('input'),
        text = window.location.href;

    document.body.appendChild(dummy);
    dummy.value = text;
    dummy.select();
    document.execCommand('copy');
    document.body.removeChild(dummy);
})

